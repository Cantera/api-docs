
:html_theme.sidebar_secondary.remove:

.. py:currentmodule:: cantera


.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/matlab_experimental/ignite_hp.m"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_matlab_experimental_ignite_hp.m>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_matlab_experimental_ignite_hp.m:

Constant pressure ignition with user-specified equations
========================================================


Solves the same ignition problem as :doc:`reactor1.m <reactor1>`, but uses
function :doc:`conhp.m <conhp>` to implement the governing equations.

.. tags:: Matlab, combustion, user-defined model, ignition delay, plotting

.. GENERATED FROM PYTHON SOURCE LINES 0-39

.. code-block:: Matlab

    function ignite_hp(gas)
        clear all
        close all

        tic
        help ignite_hp

        if nargin == 0
            gas = Solution('gri30.yaml', 'gri30');
        end

        mw = gas.molecularWeights;
        gas.TPX = {1001.0, OneAtm, 'H2:2,O2:1,N2:4'};

        y0 = [gas.T
              gas.X'];
        tel = [0, 0.001];
        options = odeset('RelTol', 1.e-5, 'AbsTol', 1.e-12, 'Stats', 'on');
        t0 = cputime;
        out = ode15s(@conhp, tel, y0, options, gas, mw);
        disp(['CPU time = ' num2str(cputime - t0)]);

        if nargout == 0
            % plot the temperature and OH mole fractions.
            figure(1);
            plot(out.x, out.y(1, :));
            xlabel('time');
            ylabel('Temperature');
            title(['Final T = ' num2str(out.y(1, end)), ' K']);

            figure(2);
            ioh = gas.speciesIndex('OH');
            plot(out.x, out.y(1 + ioh, :));
            xlabel('time');
            ylabel('Mass Fraction');
            title('OH Mass Fraction');
        end

        toc
    end

.. _sphx_glr_download_examples_matlab_experimental_ignite_hp.m:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Matlab source code: ignite_hp.m <ignite_hp.m>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: ignite_hp.zip <ignite_hp.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
