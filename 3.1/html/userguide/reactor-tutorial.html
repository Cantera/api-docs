
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Using Reactor Networks for Time Integration &#8212; Cantera 3.1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=55ce3b32" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=dd1205ac"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>window.MathJax = {"tex": {"macros": {"t": ["\\mathrm{#1}", 1], "pxpy": ["\\frac{\\partial #1}{\\partial #2}", 2]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'userguide/reactor-tutorial';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = '/dev/_static/doc-versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '3.1';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using Cantera from C++" href="cxx-tutorial.html" />
    <link rel="prev" title="Introduction to YAML Input Files" href="input-tutorial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
     
  

<a class="navbar-brand logo" href="/index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/cantera-logo.png" class="logo__image only-light" alt="Cantera"/>
    <script>document.write(`<img src="../_static/cantera-logo.png" class="logo__image only-dark" alt="Cantera"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install/index.html">
    Install
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../reference/index.html">
    Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../develop/index.html">
    Develop
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="/community.html">
    Community
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Cantera/cantera" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install/index.html">
    Install
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../reference/index.html">
    Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../develop/index.html">
    Develop
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="/community.html">
    Community
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Cantera/cantera" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="python-tutorial.html">Python Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="input-tutorial.html">Introduction to YAML Input Files</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Using Reactor Networks for Time Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="cxx-tutorial.html">Using Cantera from C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="compiling-cxx.html">Compiling Cantera C++ Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="ck2yaml-tutorial.html">Converting Chemkin Format Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating-mechanisms.html">Creating YAML Mechanism Files from Scratch</a></li>
<li class="toctree-l1"><a class="reference internal" href="thermobuild.html">Converting Data from NASA ThermoBuild</a></li>
<li class="toctree-l1"><a class="reference internal" href="input-errors.html">Handling Errors in Input Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="legacy2yaml-tutorial.html">Converting Legacy CTI and XML Input Files to YAML</a></li>
<li class="toctree-l1"><a class="reference internal" href="flame-temperature.html">Calculating Adiabatic Flame Temperature</a></li>
<li class="toctree-l1"><a class="reference internal" href="heating-value.html">Calculating Heating Value of a Fuel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/python/kinetics/lithium_ion_battery.html">Lithium Ion Battery Discharge Curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="extensible-reactor.html">Extending Reactor Models with Custom Equations</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item"><div id="numfocus">
<a href="https://numfocus.org/donate-to-cantera"
   class="sd-sphinx-override sd-btn sd-text-wrap sd-btn-secondary reference external"
   type="button">Donate to Cantera</a>
<a href="https://numfocus.org/"><img src="../_static/images/powered_by_NumFOCUS.svg" border="0" alt="NumFOCUS"/></a>
</div></div>
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">User Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Using...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="using-reactor-networks-for-time-integration">
<h1>Using Reactor Networks for Time Integration<a class="headerlink" href="#using-reactor-networks-for-time-integration" title="Link to this heading">#</a></h1>
<p>This guide explains the basics of setting up and integrating the governing equations of
a transient reactor network problem.</p>
<section id="setting-up-a-reactor-network">
<h2>Setting up a Reactor Network<a class="headerlink" href="#setting-up-a-reactor-network" title="Link to this heading">#</a></h2>
<p>First, let’s take a look at a basic example to see how we might utilize Cantera’s time
integration functionality. We’ll simulate an isolated reactor in Python that is filled
with a homogeneous gas mixture. The gas state used in this example is arbitrary, but
interesting because it’s explosive.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import the Cantera Python module</span>
<span class="kn">import</span> <span class="nn">cantera</span> <span class="k">as</span> <span class="nn">ct</span>

<span class="c1"># Create a gas mixture using the GRI-Mech 3.0 mechanism.</span>
<span class="c1"># This mechanism is included with Cantera for use in examples, but is not</span>
<span class="c1"># recommended for research use.</span>
<span class="n">gas</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s2">&quot;gri30.yaml&quot;</span><span class="p">)</span>

<span class="c1"># set gas to an interesting state</span>
<span class="n">gas</span><span class="o">.</span><span class="n">TPX</span> <span class="o">=</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="n">ct</span><span class="o">.</span><span class="n">one_atm</span><span class="p">,</span> <span class="s2">&quot;H2:2,O2:1,N2:4&quot;</span>

<span class="c1"># create a reactor containing the gas</span>
<span class="n">reac</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">IdealGasReactor</span><span class="p">(</span><span class="n">gas</span><span class="p">)</span>

<span class="c1"># Add the reactor to a new ReactorNet simulator</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">ReactorNet</span><span class="p">([</span><span class="n">reac</span><span class="p">])</span>

<span class="c1"># View the initial state of the mixture</span>
<span class="n">reac</span><span class="o">.</span><span class="n">thermo</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  gri30:

       temperature   1000 K
          pressure   1.0132e+05 Pa
           density   0.25781 kg/m^3
  mean mol. weight   21.155 kg/kmol
   phase of matter   gas

                          1 kg             1 kmol     
                     ---------------   ---------------
          enthalpy        1.0127e+06        2.1423e+07  J
   internal energy        6.1963e+05        1.3108e+07  J
           entropy             10427        2.2058e+05  J/K
    Gibbs function        -9.414e+06       -1.9915e+08  J
 heat capacity c_p            1527.9             32322  J/K
 heat capacity c_v            1134.9             24008  J/K

                      mass frac. Y      mole frac. X     chem. pot. / RT
                     ---------------   ---------------   ---------------
                H2          0.027227           0.28571           -18.758
                O2           0.21608           0.14286           -28.512
                N2            0.7567           0.57143            -25.41
     [  +50 minor]                 0                 0  
</pre></div>
</div>
</div>
</div>
<p>Now, let’s advance the simulation in time to an absolute time of 1 second, and examine
how the state of the gas has changed. There isn’t anything special about choosing 1
second as the end time for the integration; any end time can be chosen. We are choosing
1 second here because after that amount of time, the mixture will have almost certainly
ignited for a wide range of initial conditions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># advance the simulation to the specified absolute time, t = 1 sec</span>
<span class="n">sim</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># view the updated state of the mixture, reflecting properties at t = 1 sec</span>
<span class="n">reac</span><span class="o">.</span><span class="n">thermo</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  gri30:

       temperature   2867.2 K
          pressure   2.5924e+05 Pa
           density   0.25781 kg/m^3
  mean mol. weight   23.708 kg/kmol
   phase of matter   gas

                          1 kg             1 kmol     
                     ---------------   ---------------
          enthalpy        1.6252e+06        3.8529e+07  J
   internal energy        6.1963e+05         1.469e+07  J
           entropy             11252        2.6677e+05  J/K
    Gibbs function       -3.0638e+07       -7.2637e+08  J
 heat capacity c_p            1759.3             41709  J/K
 heat capacity c_v            1408.6             33395  J/K

                      mass frac. Y      mole frac. X     chem. pot. / RT
                     ---------------   ---------------   ---------------
                H2         0.0035836          0.042142           -22.913
                 H        0.00056302          0.013242           -11.457
                 O         0.0032005         0.0047426           -16.811
                O2          0.015733          0.011657           -33.621
                OH          0.017396           0.02425           -28.267
               H2O           0.19703           0.25929           -39.724
               HO2        1.0699e-05        7.6852e-06           -45.078
              H2O2        9.0899e-07        6.3357e-07           -56.535
                 N        1.6832e-06        2.8488e-06           -13.859
                NH        3.6478e-07        5.7596e-07           -25.316
               NH2        1.1008e-07        1.6288e-07           -36.772
               NH3        9.8884e-08        1.3765e-07           -48.229
               NNH        9.2324e-08        7.5418e-08           -39.174
                NO          0.010841         0.0085656            -30.67
               NO2        4.0165e-06        2.0698e-06            -47.48
               N2O        1.2929e-06        6.9643e-07           -44.528
               HNO        1.3651e-06        1.0435e-06           -42.126
                N2           0.75163           0.63609           -27.718
     [  +35 minor]       -3.3465e-25       -2.2393e-25  
</pre></div>
</div>
</div>
</div>
</section>
<section id="methods-for-time-integration">
<h2>Methods for Time Integration<a class="headerlink" href="#methods-for-time-integration" title="Link to this heading">#</a></h2>
<p>The state of a <a class="reference internal" href="../python/zerodim.html#cantera.ReactorNet" title="cantera.ReactorNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReactorNet</span></code></a> can be advanced in time by one of the following
three methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">step()</span></code>: The <code class="docutils literal notranslate"><span class="pre">step()</span></code> method computes the state of the system after one time step.
The size of the step is determined by SUNDIALS when the method is called. SUNDIALS
determines the step size by estimating the local error, which must satisfy tolerance
conditions. The step is redone with reduced step size whenever that error test fails.
SUNDIALS also periodically checks if the maximum step size is being used. The time
step must not be larger than a predefined maximum time step <span class="math notranslate nohighlight">\(\Delta t_\t{max}\)</span>. The
new time <span class="math notranslate nohighlight">\(t_\t{new}\)</span> at the end of the single step is returned by this function. This
method produces the highest time resolution in the output data of the methods
implemented in Cantera.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">advance(t_new)</span></code>: This method computes the state of the system at the user-provided
time <span class="math notranslate nohighlight">\(t_\t{new}\)</span>. <span class="math notranslate nohighlight">\(t_\t{new}\)</span> is the absolute time from the initial time of the
system. Although the user specifies the time when integration should stop, SUNDIALS
chooses the time step size as the network is integrated. Many internal SUNDIALS time
steps are usually required to reach <span class="math notranslate nohighlight">\(t_\t{new}\)</span>. As such, <code class="docutils literal notranslate"><span class="pre">advance(t_new)</span></code> preserves
the accuracy of using <code class="docutils literal notranslate"><span class="pre">step()</span></code> but allows consistent spacing in the output data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">advance_to_steady_state(max_steps,</span> <span class="pre">residual_threshold,</span> <span class="pre">atol,</span> <span class="pre">write_residuals)</span></code>
<em>Python interface only</em>: If the steady state solution of a reactor network is of
interest, this method can be used. Internally, the steady state is approached by time
stepping. The network is considered to be at steady state if the feature-scaled
residual of the state vector is below a given threshold value (which by default is 10
times the time step <code class="docutils literal notranslate"><span class="pre">rtol</span></code>).</p></li>
</ul>
<section id="limiting-timesteps">
<h3>Limiting Timesteps<a class="headerlink" href="#limiting-timesteps" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">advance(t_new)</span></code> approach is typically used when consistent, regular, time steps are
required in the output data. This usually simplifies comparisons among many simulation
results at a single time point. However, some detail, for example, a fast ignition
process, might not be resolved in the output data if the user-provided time step is not
small enough.</p>
<p>To avoid losing this detail, the <a class="reference external" href="../cxx/dc/d5e/classCantera_1_1Reactor.html#aab61d9ce60a231d27a43588caeeabb30">Reactor::setAdvanceLimit()</a> method (C++) or the
<a class="reference internal" href="../python/zerodim.html#cantera.Reactor.set_advance_limit" title="cantera.Reactor.set_advance_limit"><code class="xref py py-func docutils literal notranslate"><span class="pre">Reactor.set_advance_limit()</span></code></a> method (Python) can be used to set the maximum
amount that a specified solution component can change between output times. For an
example of this feature’s use, see the example
<a class="reference internal" href="../examples/python/reactors/reactor1.html"><span class="doc std std-doc">reactor1.py</span></a>. However, as a tradeoff, the time step
sizes in the output data are no longer guaranteed to be uniform.</p>
</section>
<section id="setting-tolerances">
<h3>Setting Tolerances<a class="headerlink" href="#setting-tolerances" title="Link to this heading">#</a></h3>
<p>Even though Cantera comes pre-defined with reasonable default values for tolerances and
the maximum internal time step, the solver may not be correctly configured for the
specific system. In this case SUNDIALS may stop with an error. To solve this problem,
three parameters can be tuned:</p>
<ol class="arabic simple">
<li><p>the absolute tolerances</p></li>
<li><p>the relative tolerances</p></li>
<li><p>the maximum time step size</p></li>
</ol>
<p>Reducing the third value is particularly useful when dealing with abrupt changes in the
boundary conditions. One example of this is opening or closing valves; see also the
<a class="reference internal" href="../examples/python/reactors/ic_engine.html"><span class="doc std std-doc">IC engine example</span></a>.</p>
</section>
</section>
<section id="adding-inlets-and-outlets">
<h2>Adding Inlets and Outlets<a class="headerlink" href="#adding-inlets-and-outlets" title="Link to this heading">#</a></h2>
<p>The following examples demonstrate the use of <a class="reference internal" href="../reference/reactors/interactions.html#sec-flow-device"><span class="std std-ref">flow devices</span></a> such
as valves and mass flow controllers to model the inlets and outlets of reactors:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../examples/python/reactors/mix1.html"><span class="doc std std-doc">Mixing two streams</span></a></p></li>
<li><p><a class="reference internal" href="../examples/python/reactors/fuel_injection.html"><span class="doc std std-doc">Soot precursor formation with time-varying mass flow rate</span></a></p></li>
<li><p><a class="reference internal" href="../examples/python/reactors/ic_engine.html"><span class="doc std std-doc">Diesel-type internal combustion engine simulation with gaseous fuel</span></a></p></li>
<li><p><a class="reference internal" href="../examples/cxx/combustor.html"><span class="doc std std-doc">Adiabatic combustor</span></a> (C++)</p></li>
</ul>
</section>
<section id="modeling-volume-changes-and-heat-transfer">
<h2>Modeling Volume Changes and Heat Transfer<a class="headerlink" href="#modeling-volume-changes-and-heat-transfer" title="Link to this heading">#</a></h2>
<p>The following examples demonstrate the use of <a class="reference internal" href="../reference/reactors/interactions.html#sec-wall"><span class="std std-ref">walls</span></a> to model volume changes
and heat transfer between reactors:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../examples/python/reactors/piston.html"><span class="doc std std-doc">Reactors separated by a moving piston</span></a></p></li>
<li><p><a class="reference internal" href="../examples/python/reactors/reactor2.html"><span class="doc std std-doc">Reactors with walls and heat transfer</span></a></p></li>
<li><p><a class="reference internal" href="../examples/python/reactors/ic_engine.html"><span class="doc std std-doc">Diesel-type internal combustion engine simulation with gaseous fuel</span></a></p></li>
</ul>
<p>Additional examples can be found in the
<a class="reference internal" href="../examples/python/reactors/index.html"><span class="doc std std-doc">Python Reactor Network Examples</span></a> section.</p>
</section>
<section id="accelerating-integration-with-preconditioned-sparse-iterative-methods">
<h2>Accelerating Integration with Preconditioned Sparse Iterative Methods<a class="headerlink" href="#accelerating-integration-with-preconditioned-sparse-iterative-methods" title="Link to this heading">#</a></h2>
<p>The <a class="reference internal" href="../reference/reactors/ideal-gas-mole-reactor.html"><span class="doc std std-doc">Ideal Gas Control Volume Mole Reactor</span></a> and the
<a class="reference internal" href="../reference/reactors/ideal-gas-constant-pressure-mole-reactor.html"><span class="doc std std-doc">Ideal Gas Constant Pressure Mole Reactor</span></a> are able to be
solved using preconditioned sparse iterative methods, instead of the normal direct
linear methods. Using these solvers can greatly speed up integration for systems with
hundreds or thousands of species <span id="id1">[<a class="reference internal" href="../reference/bibliography.html#id56" title="A. S. Walker, R. L. Speth, and K. E. Niemeyer. Generalized preconditioning for accelerating simulations with large kinetic models. Proceedings of the Combustion Institute, 39(4):5395–5403, June 2023. URL: https://www.sciencedirect.com/science/article/pii/S1540748922003273, doi:10.1016/j.proci.2022.07.256.">Walker <em>et al.</em>, 2023</a>]</span>.</p>
<p>To enable the use of this solver, a preconditioner object needs to be created and
specified for use by the reactor network. The previous example can be modified as
follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cantera</span> <span class="k">as</span> <span class="nn">ct</span>
<span class="n">gas</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s2">&quot;gri30.yaml&quot;</span><span class="p">)</span>
<span class="n">gas</span><span class="o">.</span><span class="n">TPX</span> <span class="o">=</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="n">ct</span><span class="o">.</span><span class="n">one_atm</span><span class="p">,</span> <span class="s2">&quot;H2:2,O2:1,N2:4&quot;</span>
<span class="n">reac</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">IdealGasMoleReactor</span><span class="p">(</span><span class="n">gas</span><span class="p">)</span>  <span class="c1"># Use reactor type that supports preconditioning</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">ReactorNet</span><span class="p">([</span><span class="n">reac</span><span class="p">])</span>
<span class="n">precon</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">AdaptivePreconditioner</span><span class="p">()</span>  <span class="c1"># Create the preconditioner</span>
<span class="n">sim</span><span class="o">.</span><span class="n">preconditioner</span> <span class="o">=</span> <span class="n">precon</span>  <span class="c1"># Add it to the network</span>
</pre></div>
</div>
</div>
</div>
<p>The results of the time integration are the same as before:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">reac</span><span class="o">.</span><span class="n">thermo</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  gri30:

       temperature   2867.2 K
          pressure   2.5924e+05 Pa
           density   0.25781 kg/m^3
  mean mol. weight   23.708 kg/kmol
   phase of matter   gas

                          1 kg             1 kmol     
                     ---------------   ---------------
          enthalpy        1.6252e+06         3.853e+07  J
   internal energy        6.1963e+05         1.469e+07  J
           entropy             11252        2.6677e+05  J/K
    Gibbs function       -3.0638e+07       -7.2637e+08  J
 heat capacity c_p            1759.3             41709  J/K
 heat capacity c_v            1408.6             33395  J/K

                      mass frac. Y      mole frac. X     chem. pot. / RT
                     ---------------   ---------------   ---------------
                H2         0.0035836          0.042142           -22.913
                 H        0.00056302          0.013242           -11.457
                 O         0.0032005         0.0047426           -16.811
                O2          0.015733          0.011657           -33.621
                OH          0.017396           0.02425           -28.267
               H2O           0.19703           0.25929           -39.724
               HO2        1.0699e-05        7.6852e-06           -45.078
              H2O2        9.0899e-07        6.3357e-07           -56.535
                 N        1.6832e-06        2.8488e-06           -13.859
                NH        3.6478e-07        5.7596e-07           -25.316
               NH2        1.1008e-07        1.6288e-07           -36.772
               NH3        9.8884e-08        1.3765e-07           -48.229
               NNH        9.2324e-08        7.5418e-08           -39.174
                NO          0.010841         0.0085656            -30.67
               NO2        4.0165e-06        2.0698e-06            -47.48
               N2O        1.2929e-06        6.9643e-07           -44.528
               HNO        1.3651e-06        1.0435e-06           -42.126
                N2           0.75163           0.63609           -27.718
     [  +35 minor]                 0                 0  
</pre></div>
</div>
</div>
</div>
<p>The approximate Jacobian matrices used to construct the preconditioners do not currently
account for terms that link multiple reactors in the same network. For networks of this
type, the iterative solver may exhibit convergence errors for systems where the default
direct solver does not. If the solver converges, the solution will satisfy the error
tolerances, even though the Jacobian matrix is not exact.</p>
</section>
<section id="common-reactor-types-and-their-implementation-in-cantera">
<h2>Common Reactor Types and their Implementation in Cantera<a class="headerlink" href="#common-reactor-types-and-their-implementation-in-cantera" title="Link to this heading">#</a></h2>
<section id="batch-reactor-at-constant-volume-or-at-constant-pressure">
<h3>Batch Reactor at Constant Volume or at Constant Pressure<a class="headerlink" href="#batch-reactor-at-constant-volume-or-at-constant-pressure" title="Link to this heading">#</a></h3>
<p>If you are interested in how a homogeneous chemical mixture changes state in time when
isolated from the surroundings, a simple batch reactor can be used. Two versions are
commonly considered: a rigid vessel with fixed volume but variable pressure, or a system
idealized at constant pressure but varying volume.</p>
<p>The initial state of the solution can be specified by composition and a set of intensive
thermodynamic parameters, like temperature and pressure, as a standard Cantera
<a class="reference internal" href="../python/importing.html#cantera.Solution" title="cantera.Solution"><code class="xref py py-class docutils literal notranslate"><span class="pre">Solution</span></code></a> object. From this base, a <a class="reference internal" href="../python/zerodim.html#cantera.Reactor" title="cantera.Reactor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reactor</span></code></a> or a
<a class="reference internal" href="../python/zerodim.html#cantera.ConstPressureReactor" title="cantera.ConstPressureReactor"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstPressureReactor</span></code></a> can be created, depending on if a constant volume or
constant pressure batch reactor should be considered, respectively. The behavior of the
solution in time can be simulated as a <a class="reference internal" href="../python/zerodim.html#cantera.ReactorNet" title="cantera.ReactorNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReactorNet</span></code></a> containing only the single
reactor.</p>
<p>An example for such a batch reactor is given in
<a class="reference internal" href="../examples/python/reactors/reactor1.html"><span class="doc std std-doc"><code class="docutils literal notranslate"><span class="pre">reactor1.py</span></code></span></a>.</p>
</section>
<section id="continuously-stirred-tank-reactor">
<h3>Continuously Stirred Tank Reactor<a class="headerlink" href="#continuously-stirred-tank-reactor" title="Link to this heading">#</a></h3>
<p>A Continuously Stirred Tank Reactor (CSTR), also often referred to as Well-Stirred
Reactor (WSR), Perfectly Stirred Reactor (PSR), or Longwell Reactor, is essentially a
single Cantera reactor with an inlet, an outlet, and constant volume.</p>
<p>Steady state solutions to CSTRs are often of interest. In this case, the mass flow rate
<span class="math notranslate nohighlight">\(\dot{m}\)</span> is constant and equal at inlet and outlet. The mass contained in the control
volume, <span class="math notranslate nohighlight">\(m\)</span>, divided by <span class="math notranslate nohighlight">\(\dot{m}\)</span> defines the mean residence time of the fluid in the
control volume.</p>
<p>While Cantera always solves a transient problem, if you are interested in steady-state
conditions, you can run your simulation for a long time until the states are converged.
This integration process can be managed automatically using the
<a class="reference internal" href="../python/zerodim.html#cantera.ReactorNet.advance_to_steady_state" title="cantera.ReactorNet.advance_to_steady_state"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ReactorNet.advance_to_steady_state()</span></code></a> method. See
<a class="reference internal" href="../examples/python/reactors/combustor.html"><span class="doc std std-doc"><code class="docutils literal notranslate"><span class="pre">combustor.py</span></code></span></a> for an example using this method.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>A problem can be the ignition of a CSTR: If the reactants are not reactive enough, the
simulation can result in the trivial solution that inflow and outflow states are
identical. To solve this problem, the reactor can be initialized with a high temperature
and/or radical concentration. A good approach is to use the equilibrium composition of
the reactants (which can be computed using Cantera’s <a class="reference internal" href="../python/thermo.html#cantera.ThermoPhase.equilibrate" title="cantera.ThermoPhase.equilibrate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ThermoPhase.equilibrate()</span></code></a>
function) as an initial guess. This method is demonstrated in the
<a class="reference internal" href="../examples/python/reactors/combustor.html"><span class="doc std std-doc"><code class="docutils literal notranslate"><span class="pre">combustor.py</span></code></span></a> example.</p>
</div>
</section>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-a-reactor-network">Setting up a Reactor Network</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methods-for-time-integration">Methods for Time Integration</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#limiting-timesteps">Limiting Timesteps</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-tolerances">Setting Tolerances</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-inlets-and-outlets">Adding Inlets and Outlets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling-volume-changes-and-heat-transfer">Modeling Volume Changes and Heat Transfer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accelerating-integration-with-preconditioned-sparse-iterative-methods">Accelerating Integration with Preconditioned Sparse Iterative Methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#common-reactor-types-and-their-implementation-in-cantera">Common Reactor Types and their Implementation in Cantera</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#batch-reactor-at-constant-volume-or-at-constant-pressure">Batch Reactor at Constant Volume or at Constant Pressure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#continuously-stirred-tank-reactor">Continuously Stirred Tank Reactor</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/userguide/reactor-tutorial.md.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2001-2024, Cantera Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>