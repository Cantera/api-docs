
:html_theme.sidebar_secondary.remove:

.. py:currentmodule:: cantera


.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/matlab_experimental/reactor_ode.m"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_matlab_experimental_reactor_ode.m>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_matlab_experimental_reactor_ode.m:

ODE system for a generic zero-dimensional reactor
=================================================


Function ``REACTOR_ODE`` evaluates the system of ordinary differential equations
for a zero-dimensional reactor with arbitrary heat transfer and volume change.
Used in :doc:`ignite.m <ignite>`.

Solution vector components:
   :y(1):     Total internal energy U
   :y(2):     Volume V
   :y(3):     Mass of species 1
   :....:
   :y(2+nsp): Mass of last species

.. GENERATED FROM PYTHON SOURCE LINES 0-37

.. code-block:: Matlab

    function dydt = reactor_ode(t, y, gas, vdot, area, heatflux)
        [m, n] = size(y);
        dydt = zeros(m, n);

        for j = 1:n
            this_y = y(:, j);
            int_energy = this_y(1);
            vol = this_y(2);
            masses = this_y(3:end);

            % evaluate the total mass, and the specific internal energy and volume.
            total_mass = sum(masses);
            u_mass = int_energy / total_mass;
            v_mass = vol / total_mass;

            % set the state of the gas by specifying (u,v,{Y_k})
            gas.Y = masses;
            gas.UV = {u_mass v_mass};
            p = gas.P;

            % volume equation
            vdt = feval(vdot, t, vol, gas);

            % energy equation
            a = feval(area, t, vol);
            q = feval(heatflux, t, gas);
            udt = -p * vdt + a * q;

            % species equations
            ydt = total_mass * gas.massProdRate;

            % set up column vector for dydt
            dydt(:, j) = [udt
                         vdt
                         ydt'];
        end

    end

.. _sphx_glr_download_examples_matlab_experimental_reactor_ode.m:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Matlab source code: reactor_ode.m <reactor_ode.m>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: reactor_ode.zip <reactor_ode.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
