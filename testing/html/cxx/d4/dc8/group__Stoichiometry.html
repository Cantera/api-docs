<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cantera: Stoichiometry</title>
<link rel="shortcut icon" href="../../../_static/images/favicon.png">
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../cantera-doxygen.css" rel="stylesheet" type="text/css"/>
<!-- ... other metadata & script includes ... -->
<script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
</script>
<script type="text/javascript" src="../../doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript">
    DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript">
    DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../cantera-icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cantera
   &#160;<span id="projectnumber">3.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<div>
  <ul class="sm sm-dox" style="display: block;">
    <li><a href="../../../install/index.html">Install</a></li>
    <li><a href="../../../userguide/index.html">User Guide</a></li>
    <li><a href="../../../examples/index.html">Examples</a></li>
    <li><a id="selected" href="../../../reference/index.html">Reference</a></li>
    <li><a href="../../../develop/index.html">Develop</a></li>
    <li><a href="/community.html">Community</a></li>
  </ul>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d4/dc8/group__Stoichiometry.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle"><div class="title">Stoichiometry<div class="ingroups"><a class="el" href="../../d1/dc2/group__chemkinetics.html">Chemical Kinetics</a> &raquo; <a class="el" href="../../d1/d58/group__rateEvaluators.html">Rate Evaluators</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>The classes defined here implement simple operations that are used by class <a class="el" href="../../d4/dc4/classCantera_1_1Kinetics.html" title="Public interface for kinetics managers.">Kinetics</a> to compute things like rates of progress, species production rates, etc.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for Stoichiometry:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d4/dc8/group__Stoichiometry.svg" width="298" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The classes defined here implement simple operations that are used by class <a class="el" href="../../d4/dc4/classCantera_1_1Kinetics.html" title="Public interface for kinetics managers.">Kinetics</a> to compute things like rates of progress, species production rates, etc. </p>
<p>In general, a reaction mechanism may involve many species and many reactions, but any given reaction typically only involves a few species as reactants, and a few as products. Therefore, the matrix of stoichiometric coefficients is very sparse. Not only is it sparse, but the non-zero matrix elements often have the value 1, and in many cases no more than three coefficients are non-zero for the reactants and/or the products.</p>
<p>For the present purposes, we will consider each direction of a reversible reaction to be a separate reaction. We often need to compute quantities that can formally be written as a matrix product of a stoichiometric coefficient matrix and a vector of reaction rates. For example, the species creation rates are given by</p>
<p class="formulaDsp">
\[
 \dot C_k = \sum_k \nu^{(p)}_{k,i} R_i
\]
</p>
<p>where \( \nu^{(p)_{k,i}} \) is the product-side stoichiometric coefficient of species <em>k</em> in reaction <em>i</em>. This could be done by straightforward matrix multiplication, but would be inefficient, since most of the matrix elements of \( \nu^{(p)}_{k,i} \) are zero. We could do better by using sparse-matrix algorithms to compute this product.</p>
<p>If the reactions are general ones, with non-integral stoichiometric coefficients, this is about as good as we can do. But we are particularly concerned here with the performance for very large reaction mechanisms, which are usually composed of elementary reactions, which have integral stoichiometric coefficients. Furthermore, very few elementary reactions involve more than 3 product or reactant molecules.</p>
<p>But we can do even better if we take account of the special structure of this matrix for elementary reactions involving three or fewer product molecules (or reactant molecules).</p>
<p>To take advantage of this structure, reactions are divided into four groups. These classes are designed to take advantage of this sparse structure when computing quantities that can be written as matrix multiplies.</p>
<p>They are designed to explicitly unroll loops over species or reactions for operations on reactions that require knowing the reaction stoichiometry.</p>
<p>This module consists of class <a class="el" href="../../dc/d68/classCantera_1_1StoichManagerN.html" title="This class handles operations involving the stoichiometric coefficients on one side of a reaction (re...">StoichManagerN</a>, and classes <a class="el" href="../../d3/d12/classCantera_1_1C1.html" title="Handles one species in a reaction.">C1</a>, <a class="el" href="../../dc/daf/classCantera_1_1C2.html" title="Handles two species in a single reaction.">C2</a>, and <a class="el" href="../../d2/d33/classCantera_1_1C3.html" title="Handles three species in a reaction.">C3</a>. Classes <a class="el" href="../../d3/d12/classCantera_1_1C1.html" title="Handles one species in a reaction.">C1</a>, <a class="el" href="../../dc/daf/classCantera_1_1C2.html" title="Handles two species in a single reaction.">C2</a>, and <a class="el" href="../../d2/d33/classCantera_1_1C3.html" title="Handles three species in a reaction.">C3</a> handle operations involving one, two, or three species, respectively, in a reaction. Instances are instantiated with a reaction number, and n species numbers (n = 1 for <a class="el" href="../../d3/d12/classCantera_1_1C1.html" title="Handles one species in a reaction.">C1</a>, etc.). All three classes have the same interface.</p>
<p>These classes are designed for use by <a class="el" href="../../dc/d68/classCantera_1_1StoichManagerN.html" title="This class handles operations involving the stoichiometric coefficients on one side of a reaction (re...">StoichManagerN</a>, and the operations implemented are those needed to efficiently compute quantities such as rates of progress, species production rates, reaction thermochemistry, etc. The compiler will inline these methods into the body of the corresponding <a class="el" href="../../dc/d68/classCantera_1_1StoichManagerN.html" title="This class handles operations involving the stoichiometric coefficients on one side of a reaction (re...">StoichManagerN</a> method, and so there is no performance penalty (unless inlining is turned off).</p>
<p>To describe the methods, consider class <a class="el" href="../../d2/d33/classCantera_1_1C3.html" title="Handles three species in a reaction.">C3</a> and suppose an instance is created with reaction number irxn and species numbers k0, k1, and k2.</p>
<ul>
<li>multiply(in, out) : out[irxn] is multiplied by in[k0] * in[k1] * in[k2]</li>
<li>incrementReaction(in, out) : out[irxn] is incremented by in[k0] + in[k1] + in[k2]</li>
<li>decrementReaction(in, out) : out[irxn] is decremented by in[k0] + in[k1] + in[k2]</li>
<li>incrementSpecies(in, out) : out[k0], out[k1], and out[k2] are all incremented by in[irxn]</li>
<li>decrementSpecies(in, out) : out[k0], out[k1], and out[k2] are all decremented by in[irxn]</li>
</ul>
<p>The function <a class="el" href="../../df/db0/namespaceCantera.html#a392cc9ef6cbcaddaad995e07b493dba5" title="Multiply A*b and return the result in prod. Uses BLAS routine DGEMV.">multiply()</a> is usually used when evaluating the forward and reverse rates of progress of reactions. The rate constants are usually loaded into out[]. Then <a class="el" href="../../df/db0/namespaceCantera.html#a392cc9ef6cbcaddaad995e07b493dba5" title="Multiply A*b and return the result in prod. Uses BLAS routine DGEMV.">multiply()</a> is called to add in the dependence of the species concentrations to yield a forward and reverse rop.</p>
<p>The function incrementSpecies() and its cousin decrementSpecies() is used to translate from rates of progress to species production rates. The vector in[] is preloaded with the rates of progress of all reactions. Then incrementSpecies() is called to increment the species production vector, out[], with the rates of progress.</p>
<p>The functions incrementReaction() and decrementReaction() are used to find the standard state equilibrium constant for a reaction. Here, output[] is a vector of length number of reactions, usually the standard Gibbs free energies of reaction, while input, usually the standard state Gibbs free energies of species, is a vector of length number of species.</p>
<p>Note the stoichiometric coefficient for a species in a reaction is handled by always assuming it is equal to one and then treating reactants and products for a reaction separately. Bimolecular reactions involving the identical species are treated as involving separate species.</p>
<p>The methods resizeCoeffs(), derivatives() and <a class="el" href="../../d5/d9a/group__mathTemplates.html#gadf46bfcbfcdffe08dddf8443d2ec0f64" title="Multiply elements of an array by a scale factor.">scale()</a> are used for the calculation of derivatives with respect to species mole fractions. In this context, resizeCoeffs() is used to establish a mapping between a reaction and corresponding non-zero entries of the sparse derivative matrix of the reaction rate-of-progress vector, which itself is evaluated by the derivatives() method. The <a class="el" href="../../d5/d9a/group__mathTemplates.html#gadf46bfcbfcdffe08dddf8443d2ec0f64" title="Multiply elements of an array by a scale factor.">scale()</a> method is used to multiply rop entries by reaction order and a user-supplied factor. </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d12/classCantera_1_1C1.html">C1</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles one species in a reaction.  <a href="../../d3/d12/classCantera_1_1C1.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/daf/classCantera_1_1C2.html">C2</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles two species in a single reaction.  <a href="../../dc/daf/classCantera_1_1C2.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d33/classCantera_1_1C3.html">C3</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles three species in a reaction.  <a href="../../d2/d33/classCantera_1_1C3.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d2c/classCantera_1_1C__AnyN.html">C_AnyN</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles any number of species in a reaction, including fractional stoichiometric coefficients, and arbitrary reaction orders.  <a href="../../d4/d2c/classCantera_1_1C__AnyN.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d68/classCantera_1_1StoichManagerN.html">StoichManagerN</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class handles operations involving the stoichiometric coefficients on one side of a reaction (reactant or product) for a set of reactions comprising a reaction mechanism.  <a href="../../dc/d68/classCantera_1_1StoichManagerN.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
