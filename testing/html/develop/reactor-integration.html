
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>How Time Integration of Reactor Networks Works &#8212; Cantera 3.1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=55ce3b32" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=dd1205ac"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>window.MathJax = {"tex": {"macros": {"t": ["\\mathrm{#1}", 1], "pxpy": ["\\frac{\\partial #1}{\\partial #2}", 2]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'develop/reactor-integration';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = '/dev/_static/doc-versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '3.1';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Contributing to Cantera" href="CONTRIBUTING.html" />
    <link rel="prev" title="Special Compiling Cases" href="compiling/special-cases.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
     
  

<a class="navbar-brand logo" href="/index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/cantera-logo.png" class="logo__image only-light" alt="Cantera"/>
    <script>document.write(`<img src="../_static/cantera-logo.png" class="logo__image only-dark" alt="Cantera"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install/index.html">
    Install
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../userguide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../reference/index.html">
    Reference
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Develop
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="/community.html">
    Community
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Cantera/cantera" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install/index.html">
    Install
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../userguide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../reference/index.html">
    Reference
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Develop
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="/community.html">
    Community
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Cantera/cantera" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Compiling Cantera from Source</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="compiling/compilation-reqs.html">Compilation Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="compiling/source-code.html">Downloading the Cantera source code</a></li>
<li class="toctree-l1"><a class="reference internal" href="compiling/configure-build.html">Configure and Build Cantera</a></li>
<li class="toctree-l1"><a class="reference internal" href="compiling/dependencies.html">Software used by Cantera</a></li>
<li class="toctree-l1"><a class="reference internal" href="compiling/config-options.html">Configuration Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="compiling/special-cases.html">Special Compiling Cases</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">How Cantera Works</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">How Time Integration of Reactor Networks Works</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Adding New Features to Cantera</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributing to Cantera</a></li>
<li class="toctree-l1"><a class="reference internal" href="style-guidelines.html">Code Style Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="vscode-tips.html">Configuring Visual Studio Code for Cantera</a></li>
<li class="toctree-l1"><a class="reference internal" href="writing-tests.html">Writing Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="running-tests.html">Running Tests and Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="writing-examples.html">Writing Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="doc-formatting.html">Formatting Documentation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Releasing &amp; Distributing Cantera</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="distribution-packages/release-checklist.html">Making a New Cantera Release</a></li>
<li class="toctree-l1"><a class="reference internal" href="distribution-packages/pypi-sdist-wheel.html">Distributing sdist and Wheel Packages via PyPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="distribution-packages/conda.html">Distributing Conda Package via conda-forge</a></li>
<li class="toctree-l1"><a class="reference internal" href="distribution-packages/ubuntu-ppa.html">Distributing for Ubuntu via a Personal Package Archive (PPA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="distribution-packages/windows-and-macos.html">Distributing for Windows and macOS</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item"><div id="numfocus">
<a href="https://numfocus.org/donate-to-cantera"
   class="sd-sphinx-override sd-btn sd-text-wrap sd-btn-secondary reference external"
   type="button">Donate to Cantera</a>
<a href="https://numfocus.org/"><img src="../_static/images/powered_by_NumFOCUS.svg" border="0" alt="NumFOCUS"/></a>
</div></div>
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Develop</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">How Time...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="how-time-integration-of-reactor-networks-works">
<h1>How Time Integration of Reactor Networks Works<a class="headerlink" href="#how-time-integration-of-reactor-networks-works" title="Link to this heading">#</a></h1>
<p>This section provides a developer-oriented description of how time integration of
reactor networks works in Cantera.</p>
<p>A <a class="reference external" href="../cxx/d7/def/classCantera_1_1ReactorNet.html">ReactorNet</a> object doesn’t perform time integration on its own. Instead, the role
of the <a class="reference external" href="../cxx/d7/def/classCantera_1_1ReactorNet.html">ReactorNet</a> object is to assemble a system of governing equations from
multiple reactors. It then uses the CVODES or IDAS integrators from SUNDIALS to
integrate the governing equations in time or space, respectively.</p>
<section id="creating-a-reactor-and-reactor-network">
<h2>Creating a Reactor and Reactor Network<a class="headerlink" href="#creating-a-reactor-and-reactor-network" title="Link to this heading">#</a></h2>
<p>First, let’s take a look at what happens when creating a reactor network by setting
up an isolated reactor in Python.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cantera</span> <span class="k">as</span> <span class="nn">ct</span>
<span class="n">gas</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s2">&quot;gri30.yaml&quot;</span><span class="p">)</span>
<span class="n">gas</span><span class="o">.</span><span class="n">TPX</span> <span class="o">=</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="n">ct</span><span class="o">.</span><span class="n">one_atm</span><span class="p">,</span> <span class="s2">&quot;H2:2,O2:1,N2:4&quot;</span>
<span class="n">reac</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">IdealGasReactor</span><span class="p">(</span><span class="n">gas</span><span class="p">)</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">ReactorNet</span><span class="p">([</span><span class="n">reac</span><span class="p">])</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method of the Python <a class="reference internal" href="../python/zerodim.html#cantera.ReactorNet" title="cantera.ReactorNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReactorNet</span></code></a> class calls
<a class="reference external" href="../cxx/d7/def/classCantera_1_1ReactorNet.html#a60c76483a60ec0ce596589fb6d49ccae">ReactorNet::addReactor()</a> for each <a class="reference internal" href="../python/zerodim.html#cantera.Reactor" title="cantera.Reactor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reactor</span></code></a> object provided in the list
supplied. When the first <a class="reference external" href="../cxx/dc/d5e/classCantera_1_1Reactor.html">Reactor</a> is added to the network, the <a class="reference external" href="../cxx/d7/def/classCantera_1_1ReactorNet.html">ReactorNet</a>
creates a new <a class="reference external" href="../cxx/d8/d6f/classCantera_1_1Integrator.html">Integrator</a> used to integrate the governing equations.</p>
<p>The <a class="reference external" href="../cxx/d8/d6f/classCantera_1_1Integrator.html">Integrator</a> class is Cantera’s interface for ODE/DAE system integrators.
<a class="reference external" href="../cxx/d8/d6f/classCantera_1_1Integrator.html">Integrator</a> is a <a class="reference external" href="http://www.cplusplus.com/doc/tutorial/polymorphism/">polymorphic base class</a>;
it defines a set of <em>virtual methods</em> that derived classes (the actual system
integrators) provide implementations for.</p>
<p>The <a class="reference external" href="../cxx/d9/dba/group__odeGroup.html#ga502ab661b02a814da79b2285cc888a78">newIntegrator()</a> factory function creates and returns an <a class="reference external" href="../cxx/d8/d6f/classCantera_1_1Integrator.html">Integrator</a> object
of the specified type. Calling <code class="docutils literal notranslate"><span class="pre">newIntegrator(&quot;CVODE&quot;)</span></code> creates a new
<a class="reference external" href="../cxx/d9/d6b/classCantera_1_1CVodesIntegrator.html">CVodesIntegrator</a> object for integrating an ODE system, while calling
<code class="docutils literal notranslate"><span class="pre">newIntegrator(&quot;IDA&quot;)</span></code> creates a new <a class="reference external" href="../cxx/d6/dae/classCantera_1_1IdasIntegrator.html">IdasIntegrator</a> object for integrating a DAE
system. The appropriate integrator type is determined by the <a class="reference external" href="../cxx/d7/def/classCantera_1_1ReactorNet.html">ReactorNet</a> class
based on the types of the installed reactors. A <a class="reference external" href="../cxx/da/dae/classCantera_1_1FlowReactor.html">FlowReactor</a> defines a DAE system
and uses the IDAS integrator, while the other reactor types define ODE systems and use
the CVODES integrator. In this guide, the implementation of <a class="reference external" href="../cxx/d9/d6b/classCantera_1_1CVodesIntegrator.html">CVodesIntegrator</a> is
described; <a class="reference external" href="../cxx/d6/dae/classCantera_1_1IdasIntegrator.html">IdasIntegrator</a> works in a similar way, although the IDAS function names
are different.</p>
</section>
<section id="communicating-with-sundials-using-wrapper-functions">
<h2>Communicating with SUNDIALS using Wrapper Functions<a class="headerlink" href="#communicating-with-sundials-using-wrapper-functions" title="Link to this heading">#</a></h2>
<p>Because SUNDIALS is written in C, the <a class="reference external" href="../cxx/d9/d6b/classCantera_1_1CVodesIntegrator.html">CVodesIntegrator</a> C++ wrapper is used to
access the <code class="docutils literal notranslate"><span class="pre">CVODES</span></code> solver and make the appropriate calls such as those to the
integrator function <code class="docutils literal notranslate"><span class="pre">CVode</span></code>. For details on CVODES API, see the
<a class="reference external" href="https://sundials.readthedocs.io/en/latest/cvodes/Introduction_link.html">CVODES User Guide</a>.</p>
</section>
<section id="calling-the-reactornet-advance-method">
<h2>Calling the <code class="docutils literal notranslate"><span class="pre">ReactorNet.advance</span></code> Method<a class="headerlink" href="#calling-the-reactornet-advance-method" title="Link to this heading">#</a></h2>
<p>After configuring a reactor network and its components in Cantera, a call to the
<a class="reference internal" href="../python/zerodim.html#cantera.ReactorNet.advance" title="cantera.ReactorNet.advance"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ReactorNet.advance()</span></code></a> method can be used to obtain the state of the network at a
specified time. The initial condition information is passed off to the <a class="reference external" href="../cxx/d8/d6f/classCantera_1_1Integrator.html">Integrator</a>
when calling <code class="docutils literal notranslate"><span class="pre">advance</span></code>. Transient physical and chemical interactions are simulated by
integrating the network’s system of ODE governing equations through time.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># advance the simulation to the specified absolute time, t = 1 sec</span>
<span class="n">gas</span><span class="p">()</span>  <span class="c1"># view the updated state of the mixture, reflecting properties at t = 1 sec</span>
</pre></div>
</div>
<p>Calling the <a class="reference external" href="../cxx/d7/def/classCantera_1_1ReactorNet.html#a2a886f7d58f74e8bec7c5194a143f04c">ReactorNet::advance()</a> method invokes the method
<a class="reference external" href="../cxx/d9/d6b/classCantera_1_1CVodesIntegrator.html#aa5c248a68a5df0ff791f6bc9d052c5f1">CVodesIntegrator::integrate()</a> to integrate the system to the specified time. It is
most efficient to let CVODES determine the actual integration step sizes on its own.
Therefore, we take individual time steps using CVODES using the <code class="docutils literal notranslate"><span class="pre">CVode</span></code> function until
we have reached or passed the specified time. We then interpolate the system state back
to the specified time using the <code class="docutils literal notranslate"><span class="pre">CVodeGetDky</span></code> function. With some additional handling of
special cases and errors, the implementation of <a class="reference external" href="../cxx/d9/d6b/classCantera_1_1CVodesIntegrator.html#aa5c248a68a5df0ff791f6bc9d052c5f1">CVodesIntegrator::integrate()</a> is:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">CVodesIntegrator::integrate</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">tout</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tout</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">m_time</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tout</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m_time</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">CanteraError</span><span class="p">(</span><span class="s">&quot;CVodesIntegrator::integrate&quot;</span><span class="p">,</span>
<span class="w">                           </span><span class="s">&quot;Cannot integrate backwards in time.</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">                           </span><span class="s">&quot;Requested time {} &lt; current time {}&quot;</span><span class="p">,</span>
<span class="w">                           </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">m_time</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nsteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">m_tInteg</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">tout</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nsteps</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">m_maxsteps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">string</span><span class="w"> </span><span class="n">f_errs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_func</span><span class="o">-&gt;</span><span class="n">getErrors</span><span class="p">();</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">f_errs</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">f_errs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Exceptions caught during RHS evaluation:</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f_errs</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="n">CanteraError</span><span class="p">(</span><span class="s">&quot;CVodesIntegrator::integrate&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;Maximum number of timesteps ({}) taken without reaching output &quot;</span>
<span class="w">                </span><span class="s">&quot;time ({}).</span><span class="se">\n</span><span class="s">Current integrator time: {}{}&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">nsteps</span><span class="p">,</span><span class="w"> </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">m_tInteg</span><span class="p">,</span><span class="w"> </span><span class="n">f_errs</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CVode</span><span class="p">(</span><span class="n">m_cvode_mem</span><span class="p">,</span><span class="w"> </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="n">m_y</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">m_tInteg</span><span class="p">,</span><span class="w"> </span><span class="n">CV_ONE_STEP</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">flag</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">CV_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">string</span><span class="w"> </span><span class="n">f_errs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_func</span><span class="o">-&gt;</span><span class="n">getErrors</span><span class="p">();</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">f_errs</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">f_errs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Exceptions caught during RHS evaluation:</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f_errs</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="n">CanteraError</span><span class="p">(</span><span class="s">&quot;CVodesIntegrator::integrate&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;CVodes error encountered. Error code: {}</span><span class="se">\n</span><span class="s">{}</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">                </span><span class="s">&quot;{}&quot;</span>
<span class="w">                </span><span class="s">&quot;Components with largest weighted error estimates:</span><span class="se">\n</span><span class="s">{}&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">flag</span><span class="p">,</span><span class="w"> </span><span class="n">m_error_message</span><span class="p">,</span><span class="w"> </span><span class="n">f_errs</span><span class="p">,</span><span class="w"> </span><span class="n">getErrorInfo</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">nsteps</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CVodeGetDky</span><span class="p">(</span><span class="n">m_cvode_mem</span><span class="p">,</span><span class="w"> </span><span class="n">tout</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">m_y</span><span class="p">);</span>
<span class="w">    </span><span class="n">checkError</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;integrate&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;CVodeGetDky&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">m_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tout</span><span class="p">;</span>
<span class="w">    </span><span class="n">m_sens_ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The arguments taken by the SUNDIALS
<a class="reference external" href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#cvode-solver-function"><code class="docutils literal notranslate"><span class="pre">CVode()</span></code></a>
function are:</p>
<ul class="simple">
<li><p><a class="reference external" href="../cxx/d9/d6b/classCantera_1_1CVodesIntegrator.html#a21698d62a77f6391b3a42a3b952cb94b">CVodesIntegrator::m_cvode_mem</a>, a pointer to the block of memory that was
allocated and configured during initialization.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tout</span></code> is the desired integrator output time. CVODES will not necessarily reach this
time when operating in “one step” mode, but it is used in the selection of the initial
step size.</p></li>
<li><p>After execution, <a class="reference external" href="../cxx/d9/d6b/classCantera_1_1CVodesIntegrator.html#a20d90060c20fd256083c9fba901ba71e">CVodesIntegrator::m_y</a> will contain the computed system state
at the time reached by the integrator, and will later be used to update the
<a class="reference external" href="../cxx/d7/def/classCantera_1_1ReactorNet.html">ReactorNet</a> to its time-integrated state.</p></li>
<li><p>After execution, <a class="reference external" href="../cxx/d9/d6b/classCantera_1_1CVodesIntegrator.html#aeca42ea0ce2513f3598539a7ecddb67d">CVodesIntegrator::m_tInteg</a> will contain the time reached by the
integrator.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">CV_ONE_STEP</span></code> option tells the solver to take a single internal step.</p></li>
</ul>
<p>The return value of the <code class="docutils literal notranslate"><span class="pre">CVode()</span></code> function is assigned to the <code class="docutils literal notranslate"><span class="pre">flag</span></code> variable. <code class="docutils literal notranslate"><span class="pre">CVode()</span></code>
returns the constant <code class="docutils literal notranslate"><span class="pre">CV_SUCCESS</span></code> to indicate success an error code if integration was
unsuccessful.</p>
</section>
<section id="specifying-odes-using-class-funceval">
<h2>Specifying ODEs using Class <code class="docutils literal notranslate"><span class="pre">FuncEval</span></code><a class="headerlink" href="#specifying-odes-using-class-funceval" title="Link to this heading">#</a></h2>
<p>How does <code class="docutils literal notranslate"><span class="pre">CVODES</span></code> know what ODE system it should be solving?</p>
<p>In the example above, the ODE system was actually already specified using <code class="docutils literal notranslate"><span class="pre">CVodeInit()</span></code>,
one of the functions automatically invoked by the <a class="reference external" href="../cxx/d7/def/classCantera_1_1ReactorNet.html#a25a40b6614565f755233080a384c35f1">ReactorNet::initialize()</a> method.
CVODES requires a C function with a specific signature that defines the ODE system by
computing the right-hand side of the ODE system <span class="math notranslate nohighlight">\(dy/dt\)</span> for a given value of the
independent variable, <span class="math notranslate nohighlight">\(t\)</span>, and the state vector <span class="math notranslate nohighlight">\(y\)</span>. For more information about ODE
right-hand side function requirements, see the
<a class="reference external" href="https://sundials.readthedocs.io/en/latest/cvodes/Usage/SIM.html#user-supplied-functions">CVODES User Guide</a>.</p>
<p>The <a class="reference external" href="../cxx/d9/d6b/classCantera_1_1CVodesIntegrator.html">CVodesIntegrator</a> wrapper class provides a useful C++ interface for configuring
this C function by pairing with <a class="reference external" href="../cxx/d1/dd1/classCantera_1_1FuncEval.html">FuncEval</a>, an abstract base class for ODE and DAE
right-hand-side function evaluators. Classes derived from <a class="reference external" href="../cxx/d1/dd1/classCantera_1_1FuncEval.html">FuncEval</a> implement the
evaluation of the provided ODE system.</p>
<p>An ODE right-hand-side evaluator is always needed in the ODE solution process to provide
the definition of the system, and for that reason a <a class="reference external" href="../cxx/d1/dd1/classCantera_1_1FuncEval.html">FuncEval</a> object is a required
parameter when initializing any type of <a class="reference external" href="../cxx/d8/d6f/classCantera_1_1Integrator.html">Integrator</a>.</p>
<p><a class="reference external" href="../cxx/d7/def/classCantera_1_1ReactorNet.html">ReactorNet</a> handles this requirement by inheriting the <a class="reference external" href="../cxx/d1/dd1/classCantera_1_1FuncEval.html">FuncEval</a> class,
meaning that it provides the implementation for the ODE function and actually specifies
itself using the <a class="reference external" href="https://en.cppreference.com/w/cpp/language/this"><code class="docutils literal notranslate"><span class="pre">this</span></code></a> pointer
when calling <a class="reference external" href="../cxx/d8/d6f/classCantera_1_1Integrator.html#a605b89edc3f265c7aea0d04fb131b481">Integrator::initialize()</a> in <a class="reference external" href="../cxx/d7/def/classCantera_1_1ReactorNet.html#a25a40b6614565f755233080a384c35f1">ReactorNet::initialize()</a>.</p>
<p>To be a valid <a class="reference external" href="../cxx/d1/dd1/classCantera_1_1FuncEval.html">FuncEval</a> object, a <a class="reference external" href="../cxx/d7/def/classCantera_1_1ReactorNet.html">ReactorNet</a> needs to provide implementations
for several of <a class="reference external" href="../cxx/d1/dd1/classCantera_1_1FuncEval.html">FuncEval</a>’s virtual methods, particularly the actual ODE
right-hand-side computation method, <a class="reference external" href="../cxx/d1/dd1/classCantera_1_1FuncEval.html#a9e17c43cac4143921b76690e54d94fb6">FuncEval::eval()</a>:</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">eval</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">ydot</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
</pre></div>
</div>
<p>where the arguments are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code>, the current time in seconds.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code>, a pointer to the start of the current state vector.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ydot</span></code>, a pointer to the start of the array where the computed time derivatives should
be stored.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code>, a pointer to the start of an array containing the (potentially perturbed)
sensitivity parameters, if any have been defined.</p></li>
</ul>
<p>To take a single timestep, CVODES will call <code class="docutils literal notranslate"><span class="pre">eval()</span></code> one or more times and use the
computed values of <code class="docutils literal notranslate"><span class="pre">ydot</span></code> to determine the value of <code class="docutils literal notranslate"><span class="pre">y</span></code> at the new time.</p>
<p>Within <a class="reference external" href="../cxx/d7/def/classCantera_1_1ReactorNet.html#a1f4925f042a34b2669c8e7b700a784c0">ReactorNet::eval()</a>, the governing equations for each each reactor in the
network are evaluated and assembled to form the full <code class="docutils literal notranslate"><span class="pre">ydot</span></code> vector for the system. To
handle some complexities of the <code class="docutils literal notranslate"><span class="pre">Reactor</span></code> model, namely the fact that multiple
<code class="docutils literal notranslate"><span class="pre">Reactor</span></code>s can share the same <code class="docutils literal notranslate"><span class="pre">ThermoPhase</span></code> object while having different states, the
governing equation evaluation takes place in two steps. First, the state of each
<code class="docutils literal notranslate"><span class="pre">Reactor</span></code> is set according to the values in the global state vector <code class="docutils literal notranslate"><span class="pre">y</span></code> using the
<a class="reference external" href="../cxx/d7/def/classCantera_1_1ReactorNet.html#a9c0d87fd5df7db5d086ca013e3ddb9e6">ReactorNet::updateState()</a> method, which calls the <a class="reference external" href="../cxx/dc/d5e/classCantera_1_1Reactor.html#a9c0d87fd5df7db5d086ca013e3ddb9e6">Reactor::updateState()</a> method
for each reactor:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">ReactorNet::updateState</span><span class="p">(</span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">checkFinite</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">m_nv</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m_reactors</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">n</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">m_reactors</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">updateState</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m_start</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To simplify implementation of some modifications of the governing equations, for
example, using the <a class="reference internal" href="../python/zerodim.html#cantera.ExtensibleReactor" title="cantera.ExtensibleReactor"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExtensibleReactor</span></code></a> class, the governing equations for each
reactor are written in the form:</p>
<div class="math notranslate nohighlight">
\[
\t{LHS}_i \frac{dy_i}{dt} = \t{RHS}_i
\]</div>
<p>where the <a class="reference external" href="../cxx/dc/d5e/classCantera_1_1Reactor.html#a2ff514411942b98c0c7d050b9cabb1c2">Reactor::eval()</a> method or the <code class="docutils literal notranslate"><span class="pre">eval()</span></code> method of any class derived from
<a class="reference external" href="../cxx/dc/d5e/classCantera_1_1Reactor.html">Reactor</a> calculates the values for the LHS (left-hand side) and RHS (right-hand
side) vectors, whose values default to 1 and 0, respectively, by implementing a method
with the signature:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">eval</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">LHS</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">RHS</span><span class="p">);</span>
</pre></div>
</div>
<p>These values are then assembled into the global <code class="docutils literal notranslate"><span class="pre">ydot</span></code> vector by <code class="docutils literal notranslate"><span class="pre">ReactorNet::eval()</span></code>:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">ReactorNet::eval</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">ydot</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">m_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="w">    </span><span class="n">updateState</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
<span class="w">    </span><span class="n">m_LHS</span><span class="p">.</span><span class="n">assign</span><span class="p">(</span><span class="n">m_nv</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="n">m_RHS</span><span class="p">.</span><span class="n">assign</span><span class="p">(</span><span class="n">m_nv</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m_reactors</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">n</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">m_reactors</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">applySensitivity</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="w">        </span><span class="n">m_reactors</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">eval</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">m_LHS</span><span class="p">.</span><span class="n">data</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m_start</span><span class="p">[</span><span class="n">n</span><span class="p">],</span><span class="w"> </span><span class="n">m_RHS</span><span class="p">.</span><span class="n">data</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m_start</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
<span class="w">        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">yEnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">m_reactors</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">yEnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_RHS</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">yEnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_start</span><span class="p">[</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_start</span><span class="p">[</span><span class="n">n</span><span class="p">];</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">yEnd</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">ydot</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_RHS</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">m_LHS</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">m_reactors</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">resetSensitivity</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">checkFinite</span><span class="p">(</span><span class="s">&quot;ydot&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ydot</span><span class="p">,</span><span class="w"> </span><span class="n">m_nv</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-reactor-and-reactor-network">Creating a Reactor and Reactor Network</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#communicating-with-sundials-using-wrapper-functions">Communicating with SUNDIALS using Wrapper Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calling-the-reactornet-advance-method">Calling the <code class="docutils literal notranslate"><span class="pre">ReactorNet.advance</span></code> Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specifying-odes-using-class-funceval">Specifying ODEs using Class <code class="docutils literal notranslate"><span class="pre">FuncEval</span></code></a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/develop/reactor-integration.md.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2001-2024, Cantera Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>